--> clear;

--> N=20;

--> h=1/N;

--> k=1;

--> 

--> for i=1:N
  >     if i==N
  >         a(i,i)=(1/h)+k*(h/3);
  >     else
  >         a(i,i)=(2/h)+k*(2*h/3);
  >         a(i,i+1)=(-1/h)+k*(h/6);
  >         a(i+1,i)=(-1/h)+k*(h/6);
  >     end
  > end

--> 

--> a
 a  = 

         column 1 to 4

   40.033333  -19.991667   0.          0.       
  -19.991667   40.033333  -19.991667   0.       
   0.         -19.991667   40.033333  -19.991667
   0.          0.         -19.991667   40.033333
   0.          0.          0.         -19.991667
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       

         column 5 to 8

   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
  -19.991667   0.          0.          0.       
   40.033333  -19.991667   0.          0.       
  -19.991667   40.033333  -19.991667   0.       
   0.         -19.991667   40.033333  -19.991667
   0.          0.         -19.991667   40.033333
   0.          0.          0.         -19.991667
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       

         column 9 to 12

   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
  -19.991667   0.          0.          0.       
   40.033333  -19.991667   0.          0.       
  -19.991667   40.033333  -19.991667   0.       
   0.         -19.991667   40.033333  -19.991667
   0.          0.         -19.991667   40.033333
   0.          0.          0.         -19.991667
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       

         column 13 to 16

   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
  -19.991667   0.          0.          0.       
   40.033333  -19.991667   0.          0.       
  -19.991667   40.033333  -19.991667   0.       
   0.         -19.991667   40.033333  -19.991667
   0.          0.         -19.991667   40.033333
   0.          0.          0.         -19.991667
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       

         column 17 to 20

   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
   0.          0.          0.          0.       
  -19.991667   0.          0.          0.       
   40.033333  -19.991667   0.          0.       
  -19.991667   40.033333  -19.991667   0.       
   0.         -19.991667   40.033333  -19.991667
   0.          0.         -19.991667   20.016667

--> 

--> inv(a)
 ans  =

         column 1 to 4

   0.0481775   0.0464547   0.044848    0.0433535
   0.0464547   0.0930255   0.0898082   0.0868155
   0.044848    0.0898082   0.134993    0.1304946
   0.0433535   0.0868155   0.1304946   0.1745001
   0.0419675   0.0840399   0.1263226   0.1689212
   0.0406864   0.0814746   0.1224665   0.1637647
   0.0395071   0.0791129   0.1189167   0.1590178
   0.0384265   0.0769492   0.1156643   0.1546687
   0.0374421   0.0749779   0.1127012   0.1507063
   0.0365514   0.0731941   0.1100199   0.1471209
   0.035752    0.0715934   0.1076139   0.1439035
   0.0350421   0.0701718   0.1054769   0.1410459
   0.0344198   0.0689256   0.1036038   0.1385412
   0.0338835   0.0678518   0.1019898   0.1363829
   0.0334321   0.0669478   0.1006309   0.1345657
   0.0330642   0.0662111   0.0995236   0.1330851
   0.0327791   0.0656401   0.0986653   0.1319373
   0.0325759   0.0652332   0.0980538   0.1311195
   0.0324542   0.0649895   0.0976874   0.1306296
   0.0324136   0.0649084   0.0975654   0.1304665

         column 5 to 8

   0.0419675   0.0406864   0.0395071   0.0384265
   0.0840399   0.0814746   0.0791129   0.0769492
   0.1263226   0.1224665   0.1189167   0.1156643
   0.1689212   0.1637647   0.1590178   0.1546687
   0.2119422   0.2054725   0.1995167   0.1940599
   0.2054725   0.2476942   0.2405146   0.2339365
   0.1995167   0.2405146   0.282114    0.2743981
   0.1940599   0.2339365   0.2743981   0.315546 
   0.1890884   0.2279434   0.2673685   0.3074623
   0.1845899   0.2225205   0.2610077   0.3001476
   0.180553    0.2176541   0.2552996   0.2935835
   0.1769677   0.2133321   0.25023     0.2877538
   0.173825    0.2095436   0.2457863   0.2826436
   0.1711171   0.2062792   0.2419572   0.2782404
   0.1688371   0.2035307   0.2387334   0.2745331
   0.1669794   0.2012913   0.2361066   0.2715124
   0.1655393   0.1995552   0.2340703   0.2691708
   0.1645132   0.1983183   0.2326195   0.2675024
   0.1638986   0.1975774   0.2317504   0.266503 
   0.1636939   0.1973306   0.2314609   0.2661701

         column 9 to 12

   0.0374421   0.0365514   0.035752    0.0350421
   0.0749779   0.0731941   0.0715934   0.0701718
   0.1127012   0.1100199   0.1076139   0.1054769
   0.1507063   0.1471209   0.1439035   0.1410459
   0.1890884   0.1845899   0.180553    0.1769677
   0.2279434   0.2225205   0.2176541   0.2133321
   0.2673685   0.2610077   0.2552996   0.25023  
   0.3074623   0.3001476   0.2935835   0.2877538
   0.3483251   0.3400382   0.3326018   0.3259972
   0.3400382   0.3807793   0.3724519   0.365056 
   0.3326018   0.3724519   0.4132335   0.4050278
   0.3259972   0.365056    0.4050278   0.4460125
   0.3202079   0.3585731   0.397835    0.438092 
   0.3152195   0.352987    0.3916373   0.4312671
   0.3110195   0.3482838   0.3864191   0.4255208
   0.3075974   0.3444516   0.3821673   0.4208388
   0.3049445   0.3414809   0.3788713   0.4172093
   0.3030544   0.3393643   0.3765229   0.4146233
   0.3019221   0.3380964   0.3751163   0.4130743
   0.3015451   0.3376741   0.3746478   0.4125584

         column 13 to 16

   0.0344198   0.0338835   0.0334321   0.0330642
   0.0689256   0.0678518   0.0669478   0.0662111
   0.1036038   0.1019898   0.1006309   0.0995236
   0.1385412   0.1363829   0.1345657   0.1330851
   0.173825    0.1711171   0.1688371   0.1669794
   0.2095436   0.2062792   0.2035307   0.2012913
   0.2457863   0.2419572   0.2387334   0.2361066
   0.2826436   0.2782404   0.2745331   0.2715124
   0.3202079   0.3152195   0.3110195   0.3075974
   0.3585731   0.352987    0.3482838   0.3444516
   0.397835    0.3916373   0.3864191   0.3821673
   0.438092    0.4312671   0.4255208   0.4208388
   0.4794446   0.4719755   0.4656869   0.4605629
   0.4719755   0.5138644   0.5070176   0.5014388
   0.4656869   0.5070176   0.5496164   0.5435689
   0.4605629   0.5014388   0.5435689   0.5870585
   0.4565908   0.4971142   0.538881    0.5819955
   0.4537607   0.4940329   0.5355408   0.578388 
   0.4520655   0.4921872   0.53354     0.5762272
   0.4515008   0.4915725   0.5328736   0.5755075

         column 17 to 20

   0.0327791   0.0325759   0.0324542   0.0324136
   0.0656401   0.0652332   0.0649895   0.0649084
   0.0986653   0.0980538   0.0976874   0.0975654
   0.1319373   0.1311195   0.1306296   0.1304665
   0.1655393   0.1645132   0.1638986   0.1636939
   0.1995552   0.1983183   0.1975774   0.1973306
   0.2340703   0.2326195   0.2317504   0.2314609
   0.2691708   0.2675024   0.266503    0.2661701
   0.3049445   0.3030544   0.3019221   0.3015451
   0.3414809   0.3393643   0.3380964   0.3376741
   0.3788713   0.3765229   0.3751163   0.3746478
   0.4172093   0.4146233   0.4130743   0.4125584
   0.4565908   0.4537607   0.4520655   0.4515008
   0.4971142   0.4940329   0.4921872   0.4915725
   0.538881    0.5355408   0.53354     0.5328736
   0.5819955   0.578388    0.5762272   0.5755075
   0.6265656   0.6226819   0.6203555   0.6195807
   0.6226819   0.668533    0.6660354   0.6652036
   0.6203555   0.6660354   0.7133811   0.7124901
   0.6195807   0.6652036   0.7124901   0.7615586

--> 

--> for i=1:N
  > x0=0;
  > x(i)=x0+i*h;
  > if i==N
  >   b(i)=((exp(3*(i)*h)*(-3*h+exp(3*h)-1))/(9*h))+((exp(3*(i)*h)*(3*h-1)+exp(3*((i)-1)*h))/(9*h))+1;
  > else
  >   b(i)=((exp(3*(i)*h)*(-3*h+exp(3*h)-1))/(9*h))+((exp(3*(i)*h)*(3*h-1)+exp(3*((i)-1)*h))/(9*h));
  > end
  > end

--> b
 b  = 

   0.0582007
   0.0676196
   0.0785627
   0.0912769
   0.1060486
   0.1232109
   0.1431507
   0.1663173
   0.1932332
   0.2245049
   0.2608375
   0.3030500
   0.3520938
   0.4090746
   0.4752769
   0.5521930
   0.6415568
   0.7453826
   0.8660110
   2.0061613

--> 

--> c=inv(a)*b
 c  = 

   0.2688928
   0.5355469
   0.8001581
   1.0628406
   1.3236157
   1.5823965
   1.8389719
   2.0929861
   2.3439156
   2.5910416
   2.8334180
   3.0698336
   3.2987682
   3.5183411
   3.7262513
   3.9197072
   4.0953453
   4.2491348
   4.3762670
   4.4710257

--> 

--> eksak=((1/8)-((2.718*(8-2.718+3*exp(3)))/(8*(-1-exp(2)))))*exp(x)+((2.718*(8-2.718+3*exp(3)))/(8*(-1-exp(2))))*exp(-x)-(1/8)*exp(3*x);

--> plot(x,c,x,eksak);

--> error=(abs(c-eksak));

--> error
 error  = 

   0.0171765
   0.0343956
   0.0517002
   0.0691336
   0.0867396
   0.1045620
   0.1226454
   0.1410350
   0.1597766
   0.1789169
   0.1985036
   0.2185854
   0.2392122
   0.2604352
   0.2823071
   0.3048818
   0.3282151
   0.3523646
   0.3773897
   0.4033516
